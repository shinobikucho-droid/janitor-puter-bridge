export default{async fetch(r){if("OPTIONS"===r.method)return new Response(null,{headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET,POST,OPTIONS","Access-Control-Allow-Headers":"*"}});const e=new URL(r.url);if("/"===e.pathname&&"GET"===r.method)return new Response(JSON.stringify({status:"online"}),{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}});if("/v1/chat/completions"===e.pathname&&"POST"===r.method){try{const e=await r.json(),{messages:t,model:n}=e;if(!t||0===t.length)return new Response(JSON.stringify({error:{message:"Messages required"}}),{status:400,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}});const s=t[t.length-1].content||"Hello",o=`Test response: "${s}" - Bridge works!`,a={id:"chatcmpl-"+Date.now(),object:"chat.completion",created:Math.floor(Date.now()/1e3),model:n||"puter-gpt",choices:[{index:0,message:{role:"assistant",content:o},logprobs:null,finish_reason:"stop"}],usage:{prompt_tokens:10,completion_tokens:20,total_tokens:30},system_fingerprint:"cf-worker"};return new Response(JSON.stringify(a),{status:200,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}})}catch(r){return new Response(JSON.stringify({error:{message:r.message,type:"internal_error"}}),{status:500,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}})}}return new Response(JSON.stringify({error:"Not Found"}),{status:404,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}})}}
